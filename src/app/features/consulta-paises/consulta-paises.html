<section class="fixed w-full p-4 pt-2 pb-2 flex justify-between bg-secondary">
    <input
        type="text"
        placeholder="Buscar país…"
        (input)="onBuscarPais($event)"
        class="px-3 py-2 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-accent/60"
    />
    <button
        type="button"
        (click)="toggleFiltros()"
        class="inline-flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium
        bg-primary text-on-secondary hover:bg-primary transition-colors"
    >
        <span class="material-symbols-rounded text-[20px]">tune</span>
        <span>Filtros avanzados</span>
    </button>
</section>
<section class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 p-4 pt-[70px]">
    @for (pais of paisesFiltrados; track pais.name.common) {
    <article 
        class="bg-secondary
            shadow-md 
            rounded-xl 
            p-4 
            hover:shadow-lg
            transition">
        <img 
            [src]="pais.flags.svg" 
            [alt]="'Bandera de ' + pais.name.common" 
            class="w-full h-40 object-cover  rounded-lg mb-3" 
            itemprop="image" />
        <h3 
            class="text-xl font-semibold mb-3 mt-3 text-primary" 
            itemprop="name"
        >
            {{pais.name.common}}
        </h3>
        <ul class="grid grid-cols-2 grid-rows-2 mt-2 space-y-2">
            <li class="flex gap-2">
                <span class="material-symbols-rounded text-primary/100 text-xl">public</span>
                <span class="text-primary/100">
                {{ pais.region || '—' }}
                </span>
            </li>

            <li class="flex gap-2">
                <span class="material-symbols-rounded text-primary/100 text-xl">groups</span>
                <span class="text-primary/100">
                {{ pais.population | number:'1.0-0' }}
                </span>
            </li>

            <li class="flex gap-2">
                <span class="material-symbols-rounded text-primary/100 text-xl">translate</span>
                <span class="text-primary/100">
                {{ (pais.languages | keyvalue)[0]?.value || '—' }}
                </span>
            </li>
        </ul>
        <div class="w-full flex justify-end">
            <button
                type="button"
                [routerLink]="['/paises/pais-detalle', pais.cca3]"
                class="flex items-center gap-2 rounded-lg px-3 
                    py-1.5 text-sm font-medium mt-2
                    bg-accent text-on-accent hover:bg-accent/90
                    transition-colors"
                >
                <span >Ver más</span>
                <span class="material-symbols-rounded text-[20px] leading-none">chevron_right</span>
            </button>
        </div>
    </article>
    } @empty {
        <div class="flex flex-col items-center justify-center gap-3 py-18 text-center">
            <span class="material-symbols-rounded text-[4rem] text-secondary/50">search_off</span>
            <p class="text-primary text-xl">Sin coincidencias.</p>
            <button
                (click)="limpiarFiltros()"
                type="button"
                class="flex items-center text-secondary gap-2 rounded-lg px-4 py-2 text-sm font-medium
                    bg-accent text-on-accent hover:bg-accent/90"
            >
                Limpiar filtros
            </button>
        </div>
    }
</section>

@if(displayFilters()){
<article 
    class="fixed inset-0 z-[200]"
>
    <div 
        class="absolute inset-0 bg-black/40" 
        (click)="toggleFiltros()">
    </div>
    <section
        class="absolute left-0 right-0 bottom-0 bg-white 
            rounded-t-2xl shadow-xl
            transition-transform duration-200
            max-h-[75vh] overflow-y-auto p-4
            sm:left-auto sm:right-4 sm:bottom-4 sm:rounded-2xl sm:max-w-md"
        animate.enter="sheet-in"
        animate.leave="sheet-out"
    >
        <header class="mb-3 flex items-center justify-between">
            <h3 class="text-base font-semibold text-slate-800">Filtros</h3>
            <button type="button" (click)="toggleFiltros()" class="p-2 rounded-md hover:bg-slate-100">
                <span class="material-symbols-rounded">close</span>
            </button>
        </header>
        <section class="grid gap-3">
            <select
                id="region"
                [value]="regionFiltro"
                (change)="onRegionSeleccion($event)"
                class="w-full px-3 py-2 rounded-lg border border-slate-300 bg-white
                        focus:outline-none focus:ring-2 focus:ring-accent/60"
                title="Filtrar por región"
            >
                <option value="">Todas las regiones</option>
                @for (region of regiones; track region) {
                <option [value]="region">{{ region }}</option>
                }
            </select>
            <select
                    [value]="idiomaFiltro"
                    (change)="onIdiomaSeleccion($event)"
                    class="w-full px-3 py-2 rounded-lg border border-slate-300 bg-white focus:outline-none focus:ring-2 focus:ring-accent/60"
                >
                <option value="">Todos los idiomas</option>
                @for (idioma of idiomas; track idioma) {
                <option [value]="idioma">{{ idioma }}</option>
                }
            </select>

            <button
                (click)="limpiarFiltros()"
                type="button"
                class="flex w-full items-center justify-center text-secondary gap-2 rounded-lg px-4 py-2 text-sm font-medium
                    bg-accent text-on-accent hover:bg-accent/90"
            >
                Limpiar filtros
            </button>

        </section>
    </section>
</article>
}


